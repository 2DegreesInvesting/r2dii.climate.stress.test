<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run standard transition risk stress test • r2dii.climate.stress.test</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Run standard transition risk stress test">
<meta property="og:description" content="r2dii.climate.stress.test">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">r2dii.climate.stress.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/prepare-loans-inputs.html">Prepare inputs for stress testing loans</a>
    </li>
    <li>
      <a href="../../articles/articles/read-the-outputs.html">Read and understand the output files of the stress test</a>
    </li>
    <li>
      <a href="../../articles/articles/run-stress-test.html">Run standard transition risk stress test</a>
    </li>
    <li>
      <a href="../../articles/articles/setup-project-directories.html">Set up the directories for running a climate transition risk stress test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="run-stress-test_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Run standard transition risk stress test</h1>
            
      
      
      <div class="hidden name"><code>run-stress-test.Rmd</code></div>

    </div>

    
    
<p>This vignette describes in detail, how to run a climate transition risk stress test for loans, using the function <code>run_stress_test</code> to calculate the credit risk of a loan book.</p>
<div id="assumptions" class="section level2">
<h2 class="hasAnchor">
<a href="#assumptions" class="anchor"></a>Assumptions</h2>
<p>In order to keep this vignette concise, we assume the following has been set up:</p>
<ol style="list-style-type: decimal">
<li>R and RStudio are installed</li>
<li>All required R packages are installed, this specifically includes <code>r2dii.data</code>, <code>r2dii.match</code>, <code>r2dii.analysis</code> and <code>r2dii.climate.stress.test</code>
</li>
<li>The user has obtained all relevant input files as described in the pdf manual</li>
<li>The input files are organized in a folder structure consistent with the manual</li>
<li>This notably implies the user has successfully run at least the matching part of PACTA for banks to produce the relevant project-specific input files</li>
<li>The user has successfully run the function <code><a href="../../reference/run_prep_calculation_loans.html">run_prep_calculation_loans()</a></code> to generate the input files for the main stress test function in the required format. Refer to the <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/prepare-loans-inputs.html">corresponding vignette</a> for details on how to do this.</li>
</ol>
</div>
<div id="running-the-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-analysis" class="anchor"></a>Running the Analysis</h2>
<p>The climate transition risk stress test can be run for a single set of parameters or as a sensitivity analysis for a set of parameters that iterates over one of the input arguments. We will look at both cases.</p>
<p>Use <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> to attach the package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="running-the-stress-test-for-one-scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-stress-test-for-one-scenario" class="anchor"></a>Running the Stress Test for one scenario</h2>
<p>In order to run a stress test for loans on one set of parameters, the user needs to pass exactly one value per input argument to the function <code><a href="../../reference/run_prep_calculation_loans.html">run_prep_calculation_loans()</a></code>. The only arguments that do not have a default value and must be set by the user are <code>asset_type</code>, <code>input_path_project_specific</code> and <code>input_path_project_agnostic</code>. In our case, we want to run the stress test for loans, so the easiest way to obtain results is by running:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_stress_test.html">run_stress_test</a></span><span class="op">(</span>
  <span class="st">"loans"</span>,
  input_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span>,
  input_path_project_agnostic <span class="op">=</span> <span class="st">"/path/to/agnostic/data"</span>,
  output_path <span class="op">=</span> <span class="st">"/path/to/output/directory"</span>
<span class="op">)</span></code></pre></div>
<p>This will calculate the stress test for loans and write the results into the designated output directory, using the default values for all detail arguments.</p>
<p>The user may change any detail argument by explicitly passing it to the function. Note that there are allowed ranges for each of the inputs as described in the README.</p>
<p>The detail arguments are the following (defaults in brackets):</p>
<ul>
<li>lgd_senior_claims (0.45)</li>
<li>lgd_subordinated_claims (0.75)</li>
<li>terminal_value (0)</li>
<li>risk_free_rate (0.02)</li>
<li>discount_rate (0.02)</li>
<li>div_netprofit_prop_coef (1)</li>
<li>shock_year (2030)</li>
<li>term (2)</li>
<li>company_exclusion (TRUE)</li>
</ul>
<p>The meaning of each of the detail arguments is as follows:</p>
<ul>
<li>
<code>lgd_senior_claims</code> is the loss given default used in the expected loss calculation of loans for senior claims (notably for corporate loans, so this is a potentially important parameter in this calculation)</li>
<li>
<code>lgd_subordinated_claims</code> is the loss given default used in the expected loss calculation of loans for subordinated claims (notably for corporate bonds. Not of relevance in the loans calculation)</li>
<li>
<code>terminal_value</code> the percentage of the net present value that should be used to approximate further cash flows beyond the timeframe of the model.</li>
<li>
<code>risk_free_rate</code> the risk free interest rate. Input parameter to the Merton credit risk model.</li>
<li>
<code>discount_rate</code> the annual rate at which future cash flows are discounted when calculating the net present value of companies in the loan book. Since the net present values are indirect inputs into the Merton credit risk model, this paramter my be relevant.</li>
<li>
<code>div_netprofit_prop_coef</code> Coefficient that indicates what share of the net present value should be considered to derive the equity value of a company.</li>
<li>
<code>shock_year</code> year in which the policy is introduced, that adjusts the production values of companies to stay in line with carbon budgets.</li>
<li>
<code>term</code> indicates which maturity the loans in the loan book are assumed to have. At this point we assume these are rolled over every year.</li>
<li>
<code>company_exclusion</code> Logical paramter that indicates if certain combonations of company and technology should be excluded from the analysis. At this point, it is stringly recommended to set this ti TRUE (default) because there is not yet a dedicated mechanism in place that handles companies which are phasing out certain technologies within the time frame of the production forecast.</li>
</ul>
<p>This means that the user may want to run a stress test that is tailored to their assumptions of a plausible shock scenario. For example, the user could decide to set a lower <code>risk_free_rate</code> and shock the companies earlier than by default, using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_stress_test.html">run_stress_test</a></span><span class="op">(</span>
  <span class="st">"loans"</span>,
  input_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span>,
  input_path_project_agnostic <span class="op">=</span> <span class="st">"/path/to/agnostic/data"</span>,
  output_path <span class="op">=</span> <span class="st">"/path/to/output/directory"</span>,
  risk_free_rate <span class="op">=</span> <span class="fl">0.01</span>,
  shock_year <span class="op">=</span> <span class="fl">2028</span>
<span class="op">)</span></code></pre></div>
<p>The output files are automatically written to the <code>outputs</code> sub directory of the project folder and are named:</p>
<ul>
<li><code>stress_test_results_loans_port_standard.csv</code></li>
<li><code>stress_test_results_loans_comp_standard.csv</code></li>
<li><code>stress_test_results_loans_comp_el_standard.csv</code></li>
<li><code>stress_test_results_loans_sector_pd_changes_annual_standard.csv</code></li>
<li><code>stress_test_results_loans_sector_pd_changes_overall_standard.csv</code></li>
</ul>
</div>
<div id="running-a-sensitivity-analysis-for-the-stress-test" class="section level2">
<h2 class="hasAnchor">
<a href="#running-a-sensitivity-analysis-for-the-stress-test" class="anchor"></a>Running a Sensitivity Analysis for the Stress Test</h2>
<p>In case the user wants to understand the sensitivities of the model to the input parameters mentioned above, it is straight forward to run a sensitivity analysis that does exactly that.</p>
<p>In order to do that, one simply passes a vector of allowed values for one (and only one) of the detail arguments when running the stress test function. This will lead to the model iterating over the set of values passed for the chosen argument, while keeping all other input arguments constant.</p>
<p><strong>NOTE:</strong> It is not possible to iterate over <code>asset_type</code>.</p>
<p>If the user wishes to understand the impact of the <code>shock_year</code> on the results for example, they can run the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_stress_test.html">run_stress_test</a></span><span class="op">(</span>
  <span class="st">"loans"</span>,
  input_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span>,
  input_path_project_agnostic <span class="op">=</span> <span class="st">"/path/to/agnostic/data"</span>,
  output_path <span class="op">=</span> <span class="st">"/path/to/output/directory"</span>,
  shock_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">2028</span>, <span class="fl">2032</span>, <span class="fl">2035</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>This will yield outputs with four versions of the stress test, one for each of the shock years indicated. All the results will be written into one file per output type for ease of use, e.g.:</p>
<ul>
<li><code>stress_test_results_loans_port_shock_year.csv</code></li>
<li><code>stress_test_results_loans_comp_shock_year.csv</code></li>
<li><code>stress_test_results_loans_comp_el_shock_year.csv</code></li>
<li><code>stress_test_results_loans_sector_pd_changes_annual_shock_year.csv</code></li>
<li><code>stress_test_results_loans_sector_pd_changes_overall_shock_year.csv</code></li>
</ul>
<p>The user can still alternate the default parameters of other input arguments, when iterating over the <code>shock_year</code>, e.g. if the risk_free_rate should be lower than the default, the following will work:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_stress_test.html">run_stress_test</a></span><span class="op">(</span>
  <span class="st">"loans"</span>,
  input_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span>,
  input_path_project_agnostic <span class="op">=</span> <span class="st">"/path/to/agnostic/data"</span>,
  output_path <span class="op">=</span> <span class="st">"/path/to/output/directory"</span>,
  risk_free_rate <span class="op">=</span> <span class="fl">0.01</span>,
  shock_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">2028</span>, <span class="fl">2032</span>, <span class="fl">2035</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Note that the selected detail arguments will be written to the result files so that it is always easy to understand which parameters were used in a given calculation.</p>
<div id="interpretation-of-the-output-files" class="section level3">
<h3 class="hasAnchor">
<a href="#interpretation-of-the-output-files" class="anchor"></a>Interpretation of the output files</h3>
<p>See vignette <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/read-the-outputs.html">“Read and understand the outputs”</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jacob Kastl, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
