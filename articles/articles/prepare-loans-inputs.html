<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prepare inputs for stress testing loans • r2dii.climate.stress.test</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Prepare inputs for stress testing loans">
<meta property="og:description" content="r2dii.climate.stress.test">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">r2dii.climate.stress.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/prepare-loans-inputs.html">Prepare inputs for stress testing loans</a>
    </li>
    <li>
      <a href="../../articles/articles/read-the-outputs.html">Read and understand the output files of the stress test</a>
    </li>
    <li>
      <a href="../../articles/articles/run-stress-test.html">Run standard transition risk stress test</a>
    </li>
    <li>
      <a href="../../articles/articles/setup-project-directories.html">Set up the directories for running a climate transition risk stress test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="prepare-loans-inputs_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prepare inputs for stress testing loans</h1>
            
      
      
      <div class="hidden name"><code>prepare-loans-inputs.Rmd</code></div>

    </div>

    
    
<p>This vignette describes in detail, how to prepare the required input files needed to run the climate transition risk stress test to calculate the credit risk of a loan book.</p>
<div id="assumptions" class="section level2">
<h2 class="hasAnchor">
<a href="#assumptions" class="anchor"></a>Assumptions</h2>
<p>In order to keep this vignette concise, we assume the following has been set up:</p>
<ol style="list-style-type: decimal">
<li>R and RStudio are installed</li>
<li>All required R packages are installed, this specifically includes <code>r2dii.data</code>, <code>r2dii.match</code>, <code>r2dii.analysis</code> and <code>r2dii.climate.stress.test</code>
</li>
<li>The user has obtained all relevant input files as described in the pdf manual</li>
<li>The input files are organized in a folder structure consistent with the manual</li>
<li>This notably implies the user has successfully run at least the matching part of PACTA for banks to produce the relevant project-specific input files</li>
<li>The user has set up environment variables that point to the input directories for project-specific and project-agnostic input files.</li>
</ol>
<p>Once all these requirements are met, we can produce the intermediate input files required for a climate transition risk stress test of corporate loans.</p>
</div>
<div id="running-the-loan-book-preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-loan-book-preparation" class="anchor"></a>Running the Loan Book Preparation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span></code></pre></div>
<p>The raw and matched loan book files need to be run through PACTA for banks and wrangled into the specific input format required by <code>r2dii.climate.stress.test</code>. To make this process as easy as possible for the user, we provide a function, <code><a href="../../reference/run_prep_calculation_loans.html">run_prep_calculation_loans()</a></code>, which takes care of all relevant steps with minimal input from the user.</p>
<p>The only argument that can be set is <code>credit_type</code>, which defaults to <code>"outstanding"</code> if the user passes no argument. View other options by running:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">credit_type_lookup</span></code></pre></div>
<p>If everything has been set up correctly, simply running the following command in R will read the raw and matched loan books from the indicated project-specific inputs directory, perform all calculations and wrangling required and write the intermediate input files <code>Loans_results_company.rda</code> and <code>overview_portfolio.rda</code> to the same input file directory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_prep_calculation_loans.html">run_prep_calculation_loans</a></span><span class="op">(</span>data_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span><span class="op">)</span></code></pre></div>
<p>Since the argument credit_type has a default value, it is not required to set it, in case the user wants to run the stress test on the outstanding credit values in the loan book.</p>
<p>However, it is also possible to run the analysis on the credit limits of the loans, in case these have been provided in the raw and matched loan books. To achieve this, instead of the previous command, simply run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/run_prep_calculation_loans.html">run_prep_calculation_loans</a></span><span class="op">(</span>
  data_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data"</span>,
  credit_type <span class="op">=</span> <span class="st">"credit_limit"</span>
<span class="op">)</span></code></pre></div>
<p>Regardless of which case is chosen, the intermediate input files are generated in the correct format and directory to directly continue with the main stress test calculation as described in vignette <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/run-stress-test.html">“Run stress test”</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jacob Kastl, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
