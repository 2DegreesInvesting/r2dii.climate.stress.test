<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>04 - Improve stress test by providing further project specific data • r2dii.climate.stress.test</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="04 - Improve stress test by providing further project specific data">
<meta property="og:description" content="r2dii.climate.stress.test">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2dii.climate.stress.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-setup-project-directories.html">01 - Set up project directories for climate transition risk stress test</a>
    </li>
    <li>
      <a href="../articles/02-prepare-loans-inputs.html">02 - Prepare loan input files for stress testing corporate loan books</a>
    </li>
    <li>
      <a href="../articles/03-run-stress-test.html">03 - Run transition risk stress test on corporate loan books</a>
    </li>
    <li>
      <a href="../articles/04-advanced-data-settings.html">04 - Improve stress test by providing further project specific data</a>
    </li>
    <li>
      <a href="../articles/05-read-the-outputs.html">04 - Understand the output files of the transition risk stress test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="04-advanced-data-settings_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>04 - Improve stress test by providing further project specific data</h1>
            
      
      
      <div class="hidden name"><code>04-advanced-data-settings.Rmd</code></div>

    </div>

    
    
<p>This vignette describes in detail how an analysis can be configured further by providing more custom data. The configurations are not required but, in case additional information is available, may help you improve the accuracy of your results.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>In order to keep this vignette concise, we assume that you have successfully completed all preparation steps described in the vignettes <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/01-setup-project-directories.html">“Set up project directories”</a> and <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/02-prepare-loans-inputs.html">“prepare loans inputs”</a>.</p>
</div>
<div class="section level2">
<h2 id="company---term-data">Company - term data<a class="anchor" aria-label="anchor" href="#company---term-data"></a>
</h2>
<p>Including company - term data allows you to incorporate the information you have on term values of the loan to a company in your loan book, instead of using an identical term value for all loans.</p>
<div class="section level3">
<h3 id="preparing-company---term-data">Preparing company - term data<a class="anchor" aria-label="anchor" href="#preparing-company---term-data"></a>
</h3>
<p>The data that needs to be created is a csv file named <code>company_terms.csv</code>. It holds the columns <code>company_name</code> (character, holding name of analysed companies) and term (numeric, indicates which maturity the loans to respective companies is assumed to have in years). In column <code>company_name</code> include all unique company names from <code>Loans_results_company.rda</code>, which you generated in <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/02-prepare-loans-inputs.html">prepare loans inputs</a>. If you want to use R to obtain this column you can take the following steps.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span>

<span class="va">loans_results_company_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/path/to/specific/data/inputs"</span>, <span class="st">"Loans_results_company.rda"</span><span class="op">)</span>
<span class="fu"><a href="../reference/validate_file_exists.html">validate_file_exists</a></span><span class="op">(</span><span class="va">loans_results_company_file_path</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="va">loans_results_company_file_path</span><span class="op">)</span>
<span class="va">unique_companies</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">company_name</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">unique_companies</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/some/path"</span>, <span class="st">"company_terms.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>You can now open this file in a tool of your choice, and add second column named term. In column <code>term</code> add the terms per company. Please make sure to save the result as a csv file again.</p>
<p><strong>NOTE:</strong></p>
<ul>
<li>Terms need to be whole numbers.</li>
<li>Only include values up to 5. Higher values will be capped to 5 as for calculations with longer time frames the reliability of the Merton model deteriorates.</li>
<li>Leave term blank for companies for which you lack respective information. A fallback, as provided as argument <code>term</code> to <code><a href="../reference/run_stress_test.html">run_stress_test()</a></code> will be used to fill the gaps.</li>
</ul>
</div>
<div class="section level3">
<h3 id="validating-company---term-data">Validating company - term data<a class="anchor" aria-label="anchor" href="#validating-company---term-data"></a>
</h3>
<p>Before including the file in your analysis you may want to validate that your file complies with requirements concerning structure and content. You may verify by executing the following lines of code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span>

<span class="va">company_terms_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/path/to/file"</span><span class="op">)</span>
<span class="fu"><a href="../reference/validate_file_exists.html">validate_file_exists</a></span><span class="op">(</span><span class="va">company_terms_path</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">company_terms_path</span><span class="op">)</span>
<span class="fu"><a href="../reference/validate_data_has_expected_cols.html">validate_data_has_expected_cols</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, expected_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"company_name"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/check_company_terms.html">check_company_terms</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, interactive_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="placing-file-in-folder-structure">Placing file in folder structure<a class="anchor" aria-label="anchor" href="#placing-file-in-folder-structure"></a>
</h3>
<p>In order to make sure <code>company_terms.csv</code> can be included in the analysis place it in</p>
<ul>
<li>
<code>example_folder/</code>
<ul>
<li><code>inputs/</code></li>
</ul>
</li>
</ul>
<p>as set up in <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/01-setup-project-directories.html">“Set up project directories”</a>.</p>
</div>
<div class="section level3">
<h3 id="running-the-stress-test-with-provided-company---term-data">Running the Stress Test with provided company - term data<a class="anchor" aria-label="anchor" href="#running-the-stress-test-with-provided-company---term-data"></a>
</h3>
<p>In order to include the company - term data in your analysis set argument <code>use_company_terms</code> to TRUE in the call to <code>run_stress_test</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/run_stress_test.html">run_stress_test</a></span><span class="op">(</span>
  asset_type <span class="op">=</span> <span class="st">"loans"</span>,
  input_path_project_specific <span class="op">=</span> <span class="st">"/path/to/specific/data/inputs"</span>,
  input_path_project_agnostic <span class="op">=</span> <span class="st">"/path/to/agnostic/data"</span>,
  output_path <span class="op">=</span> <span class="st">"/path/to/output/directory"</span>,
  use_company_terms <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jacob Kastl, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
