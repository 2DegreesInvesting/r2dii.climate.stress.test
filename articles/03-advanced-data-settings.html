<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>03 - Improve stress test by providing further project specific data • r2dii.climate.stress.test</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="03 - Improve stress test by providing further project specific data">
<meta property="og:description" content="r2dii.climate.stress.test">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2dii.climate.stress.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00-prerequisites.html">00 - Prerequisites</a>
    </li>
    <li>
      <a href="../articles/01-setup-project-directories.html">01 - Set up project directories for the  1in1000 model suite</a>
    </li>
    <li>
      <a href="../articles/02-run-stress-test.html">02 - Run transition (or litigation) risk stress test</a>
    </li>
    <li>
      <a href="../articles/03-advanced-data-settings.html">03 - Improve stress test by providing further project specific data</a>
    </li>
    <li>
      <a href="../articles/04-read-the-outputs.html">04 - Understand the output files of the transition risk stress test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>03 - Improve stress test by providing further
project specific data</h1>
            
      
      
      <div class="hidden name"><code>03-advanced-data-settings.Rmd</code></div>

    </div>

    
    
<p>This vignette describes in detail how an analysis can be configured
further by providing more custom data. The configurations are not
required but, in case additional information is available, may help you
improve the accuracy of your results.</p>
<div class="section level2">
<h2 id="assumptions">Assumptions<a class="anchor" aria-label="anchor" href="#assumptions"></a>
</h2>
<p>In order to keep this vignette concise, we assume the following has
been set up:</p>
<ol style="list-style-type: decimal">
<li>R and RStudio are installed.</li>
<li>All required R packages are installed, specifically
<code>r2dii.climate.stress.test</code>. Note that this may require
installing additional packages. You will be prompted to install these in
case any are missing.</li>
<li>The input files are organized in a folder structure consistent with
the one described in the vignette <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/01-setup-project-directories.html">Set
up project directories</a>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>In order to keep this vignette concise, we assume that you have
successfully completed all preparation steps described in the vignettes
<a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/01-setup-project-directories.html">Set
up project directories</a>.</p>
</div>
<div class="section level2">
<h2 id="financial-data">Financial data<a class="anchor" aria-label="anchor" href="#financial-data"></a>
</h2>
<p>Financial data provide several financial indicators on the company
level. If data is available you can replace our standard financial data
set with a data set holding your financial information on the companies
you included in the analysis.</p>
<div class="section level3">
<h3 id="preparing-financial-data">Preparing financial data<a class="anchor" aria-label="anchor" href="#preparing-financial-data"></a>
</h3>
<p>The data that needs to be created is a csv file named
<code>prewrangled_financial_data_stress_test.csv</code>to replace the
default <code>prewrangled_financial_data_stress_test.csv</code> file. It
holds the columns:</p>
<ul>
<li>
<code>company_name</code>: character, holding the name of analysed
companies.</li>
<li>
<code>company_id</code>: numeric, the id of company as classified by
asset resolution. For loans workflow a placeholder value will be
used.</li>
<li>
<code>corporate_bond_ticker</code>: character, holding the
identifier. Will be NA for loans workflow.</li>
<li>
<code>pd</code>: numeric, holding the probability of default per
company. Needs to be equal to or larger than 0 and smaller than 1.</li>
<li>
<code>net_profit_margin</code>: numeric, holding the
net_profit_margin per company. Needs to be larger than 0 and equal to or
smaller than 1.</li>
<li>
<code>debt_equity_ratio</code>: numeric, holding the ratio of
outstanding debt to the company’s equity value. This is the company’s
financial leverage. Needs to be larger than 0.</li>
<li>
<code>volatility</code>: numeric, holding the volatility of asset.
Needs to be equal to or larger than 0.</li>
</ul>
<p><strong>NOTE</strong>: No column, except for corporate_bond_ticker,
may have missing values.</p>
<p>In column <code>company_name</code> include all unique company names
from <code>Loans_results_company.rda</code>, which you generated in <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/02-prepare-loans-inputs.html">prepare
loans inputs</a>. Running the following code will generate a dataset
with all required columns. Column <code>campany_name</code> includes the
unique company names, <code>company_id</code> includes a placeholder id,
all other columns are empty.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">loans_results_company_file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/example_project/project_specific_input"</span>, <span class="st">"Loans_results_company.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/validate_file_exists.html">validate_file_exists</a></span><span class="op">(</span><span class="va">loans_results_company_file_path</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="va">loans_results_company_file_path</span><span class="op">)</span></span>
<span><span class="va">fin_companies</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">company_name</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    company_id <span class="op">=</span> <span class="fl">999</span>, </span>
<span>    corporate_bond_ticker <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    pd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    net_profit_margin <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    debt_equity_ratio <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    volatility <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">fin_companies</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/example_project/project_agnostic_input"</span>, <span class="st">"prewrangled_financial_data_stress_test.csv"</span><span class="op">)</span><span class="op">)</span> <span class="co"># NOTE that this will overwrite financial data currently stored at the location if available</span></span></code></pre></div>
<p>You can now open this file in a tool of your choice and fill in
values for the remaining variables. For column <code>company_id</code>
keep using a placeholder value (999 in example) and leave entries for
<code>corporate_bond_ticker</code>as NA. Please make sure to save the
result as a csv file again.</p>
</div>
<div class="section level3">
<h3 id="validating-financial-data">Validating financial data<a class="anchor" aria-label="anchor" href="#validating-financial-data"></a>
</h3>
<p>Before including the file in your analysis you may want to validate
that your file complies with requirements concerning structure and
content. You may verify by executing the following lines of code. You
will receive warning/error messages in case problems are detected.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test">r2dii.climate.stress.test</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">financial_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"/example_project/project_agnostic_input"</span>,</span>
<span>                                 <span class="st">"prewrangled_financial_data_stress_test.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/validate_file_exists.html">validate_file_exists</a></span><span class="op">(</span><span class="va">financial_data_path</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">financial_data_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/check_financial_data.html">check_financial_data</a></span><span class="op">(</span>financial_data <span class="op">=</span> <span class="va">data</span>, asset_type <span class="op">=</span> <span class="st">"loans"</span>, interactive_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="placing-file-in-folder-structure">Placing file in folder structure<a class="anchor" aria-label="anchor" href="#placing-file-in-folder-structure"></a>
</h3>
<p>In order to make sure your version of
<code>prewrangled_financial_data_stress_test.csv</code> is used in the
analysis place it in</p>
<ul>
<li><code>project_agnostic_input/</code></li>
</ul>
<p>as set up in <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/01-setup-project-directories.html">Set
up project directories</a>. If the respective dataset as provided by
2DII already exists there make sure to replace it with your custom
file.</p>
</div>
<div class="section level3">
<h3 id="running-the-stress-test-with-provided-financial-data">Running the Stress Test with provided financial data<a class="anchor" aria-label="anchor" href="#running-the-stress-test-with-provided-financial-data"></a>
</h3>
<p>You can now run the stress test as described in vignette <a href="https://2degreesinvesting.github.io/r2dii.climate.stress.test/articles/articles/02-run-stress-test.html">Run
stress test</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jacob Kastl, Franziska Fischer, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
