<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function reference â€¢ r2dii.climate.stress.test</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function reference" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-index">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2dii.climate.stress.test</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/articles/integration-test.html">Integration test</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Reference</h1>
    </div>

    <table class="ref-index">

    <colgroup>
      
      <col class="alias" />
      <col class="title" />
    </colgroup>

    <tbody>
      <tr>
        <th colspan="2">
          <h2 id="section-all-functions" class="hasAnchor"><a href="#section-all-functions" class="anchor"></a>All functions</h2>
          <p class="section-desc"></p>
        </th>
      </tr>
      
      
    </tbody><tbody>
      
      
      <tr>
        
        <td>
          <p><code><a href="annual_pd_change_company_sector.html">annual_pd_change_company_sector()</a></code> </p>
        </td>
        <td><p>Display the annual pd changes per company and technology.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="annual_pd_change_sector_shock_year.html">annual_pd_change_sector_shock_year()</a></code> </p>
        </td>
        <td><p>Display the annual pd changes per shock year and technology.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="apply_filters.html">apply_filters()</a></code> </p>
        </td>
        <td><p>Filter input company or portfolio data to match model specifications and
parameters. Companies with zero production in the start year are removed as
they will lead to errors in calculations down the line.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="asset_value_at_risk.html">asset_value_at_risk()</a></code> </p>
        </td>
        <td><p>Calculate percentage value change between scenarios for equity (and
temporarily other asset types) on the portfolio level</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calc_future_prod_follows_scen.html">calc_future_prod_follows_scen()</a></code> </p>
        </td>
        <td><p>Calculates the production trajectory in case the initial production plans
are to be included.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calc_late_sudden_prices.html">calc_late_sudden_prices()</a></code> </p>
        </td>
        <td><p>Calculate late and sudden prices</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calc_late_sudden_traj.html">calc_late_sudden_traj()</a></code> </p>
        </td>
        <td><p>Calculate how the production trajectory for a company/technology changes
after the policy shock hits.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calc_survival_probability_merton.html">calc_survival_probability_merton()</a></code> </p>
        </td>
        <td><p>Calculate survival probability</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calculate_aum.html">calculate_aum()</a></code> </p>
        </td>
        <td><p>Calculate aum</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calculate_pd_change_annual.html">calculate_pd_change_annual()</a></code> </p>
        </td>
        <td><p>Calculate change in probabilities of default (PDs) of loans connected to
companies at hand. This is based on the equity values derived from the DCF
model. Said Equity values are used as different starting points for the
Merton model (one reflecting the business as usual baseline scenario, the
other reflecting the late &amp; sudden shock scenario). Since we calculate the PDs
on an annual basis (start year up to year t), we use different NPVs based on
the DCF model for every year that we calculate a PD for. Only discounted
profits up until the year in question will be taken into account as the equity
starting points for each of the calculations. Prior to a policy shock, this
implies equal starting points for baseline and late and sudden scenarios and
only after the shock, we get diverging starting points.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="calculate_pd_change_overall.html">calculate_pd_change_overall()</a></code> </p>
        </td>
        <td><p>Calculate change in probabilities of default (PDs) of loans connected to
companies at hand. This is based on the equity values derived from the DCF
model. Said Equity values are used as different starting points for the
Merton model (one reflecting the business as usual baseline scenario, the
other reflecting the late &amp; sudden shock scenario). The change in PDs can
then be used to calculate the Expected Loss due to the shock on the portfolio
level.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="check_and_filter_data.html">check_and_filter_data()</a></code> </p>
        </td>
        <td><p>Check and filter data</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="check_results_structure.html">check_results_structure()</a></code> </p>
        </td>
        <td><p>Checks structure of results</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="company_asset_value_at_risk.html">company_asset_value_at_risk()</a></code> </p>
        </td>
        <td><p>Calculate percentage value change between scenarios for equity (and
temporarily other asset types) on the company-technology level</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="company_expected_loss.html">company_expected_loss()</a></code> </p>
        </td>
        <td><p>Calculate change of expected loss between scenarios for corporate loans on
the company-technology level. The function uses a maximum term of 5 years and
all loans with longer maturities are thrown into the 5 year bucket. The
calculation of PD changes that underlies the input to this function is based
on the comparison of overall NPVs of the correpsonding equity values for the
companies at hand. That is, the PD changes take into account all dscounted
future profits plus the terminal value.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="convert_cap_to_generation.html">convert_cap_to_generation()</a></code> </p>
        </td>
        <td><p>Translate power capacity to power generation. Units of generated power are
assumed to be sold and hence get priced in the net profit calculations.
This also entails converting MWh into MW per year, since we calculate yearly
profits.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="convert_power_cap_to_generation.html">convert_power_cap_to_generation()</a></code> </p>
        </td>
        <td><p>Translate power capacity to power generation</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="correct_automotive_scendata.html">correct_automotive_scendata()</a></code> </p>
        </td>
        <td><p>interpolate automotive sector scenario data for a specified set of years
note: this function should eventually be moved to the data_prep repository</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="create_stressdata_masterdata_file_paths.html">create_stressdata_masterdata_file_paths()</a></code> </p>
        </td>
        <td><p>Get path for stress test masterdata files</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="data_path.html">data_path()</a></code> </p>
        </td>
        <td><p>conveniently access stress test related files in the directory set via envvar
or options</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="degrees.html">degrees()</a></code> </p>
        </td>
        <td><p>Insert the symbol for degrees</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="dropbox_exists.html">dropbox_exists()</a></code> </p>
        </td>
        <td><p>Does this computer have a local copy of 2dii's dropbox folder?</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="exclude_companies.html">exclude_companies()</a></code> </p>
        </td>
        <td><p>Effectively exclude certain technologies of companies from calculations</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="extend_scenario_trajectory.html">extend_scenario_trajectory()</a></code> </p>
        </td>
        <td><p>Extend the scenario pathways based on the fair share approach (now known as
market share approach).  We first ensure that all scenarios are extended to
the same point in time (start of the analysis plus forecast time frame.
Then we take the first value of the production on company level as the start
value and from the second year onward, we calculate the level of production
for a company under the scenarios at hand by applying the relative changes
for the respective years to the absolute values of the previous year.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="fill_annual_profit_cols.html">fill_annual_profit_cols()</a></code> </p>
        </td>
        <td><p>Fill missing values on annual_profits</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="filter_negative_late_and_sudden.html">filter_negative_late_and_sudden()</a></code> </p>
        </td>
        <td><p>Remove negative late and sudden rows</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="format_loanbook_st.html">format_loanbook_st()</a></code> </p>
        </td>
        <td><p>Transforms the PACTA for banks output to PACTA EQ/CB format to enable use
in stress test model.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="generate_transition_shocks.html">generate_transition_shocks()</a></code> </p>
        </td>
        <td><p>Generate transition scenario shocks from a range of start years that
represent different years of when a large scale climate transition policy is
deployed.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="get_st_data_path.html">get_st_data_path()</a></code> </p>
        </td>
        <td><p>Get the path to the required stress test data location. Can be provided
either via environment variable or options.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="inner_join_report_drops.html">inner_join_report_drops()</a></code> </p>
        </td>
        <td><p>Inner join datasets and report number of dropped rows</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="keep_merton_compatible_rows.html">keep_merton_compatible_rows()</a></code> </p>
        </td>
        <td><p>Keep rows that fulfill constraints of the merton model</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="overall_pd_change_company_sector.html">overall_pd_change_company_sector()</a></code> </p>
        </td>
        <td><p>Display the overall pd changes per maturity, company and technology.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="overall_pd_change_sector_shock_year.html">overall_pd_change_sector_shock_year()</a></code> </p>
        </td>
        <td><p>Display the overall pd changes per maturity, shock year and technology.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="path_dropbox_2dii.html">path_dropbox_2dii()</a></code> </p>
        </td>
        <td><p>Easily access directories in your local copy of 2dii's Dropbox folder</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_and_prepare_project_agnostic_data.html">read_and_prepare_project_agnostic_data()</a></code> </p>
        </td>
        <td><p>Read and prepare project agnostic data</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_capacity_factors.html">read_capacity_factors()</a></code> </p>
        </td>
        <td><p>Read in power capacity factors from csv and check that all expected columns
are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_company_data.html">read_company_data()</a></code> </p>
        </td>
        <td><p>Read in company finacial data processed from eikon exports and AR master data
that contain information on multiple credit risk inputs and company
production plans, aggregated to the ticker/technology/year level for
<code>asset_type</code> bonds and aggregated to the company/technology/year level for
<code>asset_type</code> equity and aggregated to the loan_taker/technology/year level
for <code>Ã sset_type</code> loans</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_ngfs_carbon_tax.html">read_ngfs_carbon_tax()</a></code> </p>
        </td>
        <td><p>Read in NGFS carbon tax data from csv and check that all expected columns
are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_pacta_results.html">read_pacta_results()</a></code> </p>
        </td>
        <td><p>Read in the PACTA results from a given project and check that all expected
columns are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_price_data.html">read_price_data()</a></code> </p>
        </td>
        <td><p>Read in price data from csv and check that all expected columns are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_price_data_internal.html">read_price_data_internal()</a></code> </p>
        </td>
        <td><p>Read in price data from csv and check that all expected columns are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_price_data_internal_old.html">read_price_data_internal_old()</a></code> </p>
        </td>
        <td><p>Read in price data from csv and check that all expected columns are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_scenario_data.html">read_scenario_data()</a></code> </p>
        </td>
        <td><p>Read in scenario data</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="read_transition_scenarios.html">read_transition_scenarios()</a></code> </p>
        </td>
        <td><p>Read in transition scenarios from csv and check that all expected columns
are given.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="report_all_duplicate_kinds.html">report_all_duplicate_kinds()</a></code> </p>
        </td>
        <td><p>Checks data for missings and duplicates</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="report_duplicates.html">report_duplicates()</a></code> </p>
        </td>
        <td><p>Report duplicate rows</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="report_missing_col_combinations.html">report_missing_col_combinations()</a></code> </p>
        </td>
        <td><p>Identify and report missing value combinations</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="report_missings.html">report_missings()</a></code> </p>
        </td>
        <td><p>Report missing</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="run_prep_calculation_loans.html">run_prep_calculation_loans()</a></code> </p>
        </td>
        <td><p>Run stress testing for loans</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="run_stress_test_bonds.html">run_stress_test_bonds()</a></code> </p>
        </td>
        <td><p>Run stress testing for bonds</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="run_stress_test_equity.html">run_stress_test_equity()</a></code> </p>
        </td>
        <td><p>Run stress testing for equity</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="run_stress_test_loans.html">run_stress_test_loans()</a></code> </p>
        </td>
        <td><p>Run stress testing for loans</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="set_baseline_trajectory.html">set_baseline_trajectory()</a></code> </p>
        </td>
        <td><p>Defines which scenario values to use for the baseline trajectory in the
stress test.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="set_ls_trajectory.html">set_ls_trajectory()</a></code> </p>
        </td>
        <td><p>Defines which scenario values to use for the late &amp; sudden trajectory in the
stress test.</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_carbon_budget.html">show_carbon_budget()</a></code> </p>
        </td>
        <td><p>Display the carbon budget per technology over time</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_impact_by_shock_year.html">show_impact_by_shock_year()</a></code> </p>
        </td>
        <td><p>Display impact on value at risk by technology and shock year</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_pf_technology_shares.html">show_pf_technology_shares()</a></code> </p>
        </td>
        <td><p>Check the technology shares</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_price_trajectories.html">show_price_trajectories()</a></code> </p>
        </td>
        <td><p>Display the market price trajectories per technology</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_prod_baseline_target_ls_pf.html">show_prod_baseline_target_ls_pf()</a></code> </p>
        </td>
        <td><p>Compare the production trajectories per technology by baseline, target and
late_and_sudden scenarios</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_prod_trajectories.html">show_prod_trajectories()</a></code> </p>
        </td>
        <td><p>Display the market production trajectories per technology</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="show_var_change_by_shock_year.html">show_var_change_by_shock_year()</a></code> </p>
        </td>
        <td><p>Display change of results by technology and shock year</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="source_all.html">source_all()</a></code> </p>
        </td>
        <td><p>Source scripts quietly based on a list of input paths</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="validate_data_has_expected_cols.html">validate_data_has_expected_cols()</a></code> </p>
        </td>
        <td><p>Validate that a data frame contains expected columns</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="validate_file_exists.html">validate_file_exists()</a></code> </p>
        </td>
        <td><p>Validate that a file exists in a given directory</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="validate_input_values.html">validate_input_values()</a></code> </p>
        </td>
        <td><p>Check that input values are valid</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="wrangle_and_check_pacta_results.html">wrangle_and_check_pacta_results()</a></code> </p>
        </td>
        <td><p>Wrangle and check PACTA results</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="wrangle_and_check_sector_exposures.html">wrangle_and_check_sector_exposures()</a></code> </p>
        </td>
        <td><p>Wrangles and checks sector exposures</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="wrangle_financial_data.html">wrangle_financial_data()</a></code> </p>
        </td>
        <td><p>Wrangle financial data</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="wrangle_scenario_data.html">wrangle_scenario_data()</a></code> </p>
        </td>
        <td><p>Wrangle scenario data</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="write_results.html">write_results()</a></code> </p>
        </td>
        <td><p>Write the results to the project directory</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="write_results_new.html">write_results_new()</a></code> </p>
        </td>
        <td><p>Write the results to the project directory</p></td>
      </tr><tr>
        
        <td>
          <p><code><a href="write_stress_test_results.html">write_stress_test_results()</a></code> </p>
        </td>
        <td><p>Write stress test reports to output dir</p></td>
      </tr>
    </tbody>
    </table>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jacob Kastl, 2 Degrees Investing Initiative.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


