---
title: "Integration test"
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The goal of this article is to provide a developer-facing integration test. It
shows that the package can be used in a user-mode, i.e. with this package
installed in their system. This is by contrast with a developer-mode, which
implies access to the package's source code.

```{r}
library(purrr)
library(fs)
library(here)

library(r2dii.climate.stress.test)
packageVersion("r2dii.climate.stress.test")
```

Setup

```{r}
readLines(here(".Renviron"))
```

Empty outputs/

```{r}
outputs <- function() {
  dir_ls(path(Sys.getenv("ST_PROJECT_FOLDER"), "outputs"))
}

path_file(outputs())
file_delete(outputs())

outputs()
```

Populate outputs/ quietly

```{r}
run_stress_test_bonds_quietly <- quietly(run_stress_test_bonds)
done <- run_stress_test_bonds_quietly()

path_file(outputs())
```

Inspect what the result, and all the stuff printed to the console

```{r}
done
```

